%html
  %head
    %title Расписание кафедры статистического моделирования
    %script{ :src => 'js/redips-drag-min.js' }
  
  %body{ :onload => 'REDIPS.drag.init()' }
    - specs = ['sm', 'mm', 'sa']
    - specnames = ['СМ', 'ММ', 'САПР']
    %div{ :id => 'drag' }
      %table{ :width => "80%", :border => 1 }
        %tbody
          %tr
            %th{:width => '5%'}
              - specnames.each do |name|
                %td{:bgcolor => '#DDDDFF', :align => 'center', :width => '33%'}
                  = name
          - timetable.weekday_tables.each do |weekday|
            %tr
              %th

              %th{ :colspan => 3, :bgcolor => 'yellow'}
                = weekday.name

            - 1.upto(5).each do |index|
              %tr
                %th{:bgcolor => 'greenyellow', :style => 'height: 25px' }
                  = index

                - double_class = weekday.getDoubleClass(index)
                - dep_lesson = if double_class.nil? then nil else double_class.getLessonForSpec 'all' end
                - if dep_lesson.nil?
                  - specs.each do |spec|
                    %td
                      - unless double_class.nil?
                        - lesson = double_class.getLessonForSpec(spec)
                        - unless lesson.nil?
                          %div{ :class => 'drag'}
                            = lesson.course.name
                - else
                  %td{ :colspan => 3, :align => 'center' }
                    %div{ :class => 'drag'}
                      = dep_lesson.course.name
